{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>F O R W A R D</title>
    <link rel="stylesheet" href="{% static '/bootstrap/css/bootstrap.css' %}">
    <link rel="stylesheet" href="{% static 'bootstrap/css/font-awesome.css' %}">
    <link rel="stylesheet" href="{% static 'switch/bootstrap-switch.min.css' %}">
    <link rel="stylesheet" href="{% static 'mine/css/base.css' %}">
    <link rel="stylesheet" href="{% static 'mine/css/subnav.css' %}">
    <link rel="stylesheet" href="{% static 'slider/css/bootstrap-slider.css' %}">
    <link rel="stylesheet" href="{% static 'table/bootstrap-table.css' %}">
    <link rel="stylesheet" href="{% static 'datepicker/bootstrap-datetimepicker.css' %}">
    <link rel="stylesheet" href="{% static 'mine/css/display_page.css' %}">
    <script src="{% static 'bootstrap/js/jquery.min.js' %}"></script>
   <script src="{% static 'bootstrap/js/bootstrap.js' %}"></script>
    <script src="{% static 'bootstrap/js/echarts.min.js' %}"></script>
     <script src="{% static 'switch/bootstrap-switch.min.js' %}"></script>
    <script src="{% static 'slider/js/bootstrap-slider.js' %}"></script>
    <script src="{% static 'table/bootstrap-table.js' %}"></script>
    <script src="{% static 'table/bootstrap-table-zh-CN.js' %}"></script>
    <script src="{% static 'datepicker/bootstrap-datetimepicker.js' %}"></script>
    <script src="{% static 'datepicker/bootstrap-datetimepicker.zh-CN.js' %}"></script>
    <script src="{% static 'halfChart/js/raphael-2.1.4.min.js' %}"></script>
    <script src="{% static 'halfChart/js/justgage.js' %}"></script>

    <style>
        .container{
            margin-top: 80px;
            float: right;
            width: 85%;
        }
        .control-container{
            float: right;
            width: 85%;
        }
        .switch-container{
            text-align: center;
        }
        .icon-container{
            text-align: center;
            margin-top: 30px;
        }
        #ex1Slider .slider-selection {
            background: #BABABA;
        }
        .nav1{
            display: none;
        }
        .nav-header.collapsed > span.glyphicon-chevron-toggle:before {
            content: "\e114";
        }
        .nav-header > span.glyphicon-chevron-toggle:before {
            content: "\e113";
        }
        .secondmenu a {
            font-size: 12px;
            color: #4A515B;
            text-align: center;
        }
        #data-search{
            margin-top: 20px;
            height: 40px;
        }
        #sensor-query{
            margin-top: 20px;
            height: 40px;
        }
        .date-input{
            width: 180px;height: 34px;font-size: 16px;
            border-radius: 4px;
            border:1px solid #c8c8c8;
        }
        .data-show{
             width: 100%;
            height: 400px;
            border:2px solid #c8c8c8;
            overflow:auto;
        }
        .normal-color{
            display: block;
            background-color: #2aabd2;
            border-radius: 5px;
            font-size: 16px;
        }
        .alarm-color{
            display: block;
            background-color: #e50f29;
            border-radius: 5px;
            font-size: 16px;
        }

        .query-condition{
            margin-top: 40px;
            height:40px;
        }



        .width-30 {
            margin-left: 20px;margin-top: 20px;
             width: 30px;
        }
        .row1{
            margin-left: 80px;
        }
        .container1{
            margin-top: 60px;
            float: right;
            width: 75%;
        }
        .contral-icon{
            height:100px;
            width: 100px;
        }
        {# =========================================================================================================== #}
        .todo-widget .todo-list {
            list-style: none;
            margin-left: 0;
            margin-bottom: 0px;
            min-height: 40px;
            paddng-left: 0;
            position: relative;
        }
        .todo-widget .todo-list .todo-task-item {
            margin-bottom: 0;
            border-top: 1px solid #e7e7e2;
            padding: 10px 0;
            position: relative;
        }
        .todo-widget .todo-list .todo-task-item .todo-priority {
            margin-left: 10px;
            margin-right: 10px;
            float: left;
        }
        .normal {
            font-weight: normal;
        }
        .task-text {
            font-weight: bold;
            padding-top: 1px;
            margin-left: 20px;
            font-size:20px;
        }
        .todo-widget .todo-list .todo-task-item .todo-task-text {
            font-weight: bold;
            padding-top: 1px;
            color: #9d9d9d;
        }
        .todo-list h5{
            font-weight: bold;
        }
        .todo-task-text {
            font-size: 15px;
            margin-top: 20px;
        }
        .todo-widget .todo-list .todo-task-item .todo-category {
            float: right;
            margin-right: 18px;
        }
        .todo-task-item{
            height:80px;
        }
        .label {
            padding: 5px 8px;
            display: inline-block;
        }

        ul,ol,li{
            margin:0;/*设置外补白为0*/
            padding:0;/*设置内补白为0*/
        }
        .control-icon{
            height: 60px;
            width: 60px;
        }
        .control-icon:hover{
            height: 65px;
            width: 65px;
        }
        .security-icon{
            margin-left: 5px;
            margin-top: 7px;
            height: 60px;
            width: 60px;
        }
        #loader8 {
            font-size: 10px;
            position: relative;
            text-indent: -9999em;
            border-top: 2px solid rgba(255, 128, 0, 0.2);
            border-right: 2px solid rgba(255, 128, 0, 0.2);
            border-bottom: 2px solid rgba(255, 128, 0, 0.2);
            border-left: 2px solid rgba(255, 128, 0, 1);
            -webkit-animation: load8 1.1s infinite linear;
            animation: load8 1.1s infinite linear;
        }
        #loader8,
        #loader8:after {
            border-radius: 50%;
            width: 70px;
            height: 70px;
        }
        @-webkit-keyframes load8 {
            0% {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }
        @keyframes load8 {
            0% {
                -webkit-transform: rotate(0deg);
                transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }
        @-webkit-keyframes bounce-down {
            25% {-webkit-transform: translateY(-10px);}
            50%, 100% {-webkit-transform: translateY(0);}
            75% {-webkit-transform: translateY(10px);}
        }

        @keyframes bounce-down {
            25% {transform: translateY(-10px);}
            50%, 100% {transform: translateY(0);}
            75% {transform: translateY(10px);}
        }

        .animate-bounce-down{
            background:#333;
            width: 100px;
            height: 100px;
            margin:100px auto;
            -webkit-animation: bounce-down 1.5s linear infinite;
            animation: bounce-down 1.5s linear infinite;
        }

        @-webkit-keyframes bounce-up {
            25% {-webkit-transform: translateY(10px);}
            50%, 100% {-webkit-transform: translateY(0);}
            75% {-webkit-transform: translateY(-10px);}
        }

        @keyframes bounce-up {
            25% {transform: translateY(10px);}
            50%, 100% {transform: translateY(0);}
            75% {transform: translateY(-10px);}
        }

        .animate-bounce-up{
            background:#ddd;
            margin:100px auto;
            -webkit-animation: bounce-up 1.4s linear infinite;
            animation: bounce-up 1.4s linear infinite;
        }

        .boss-gradient {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(10, 9, 10, 0.8) 15%, rgba(203, 203, 203, 0.7) 100%);
        }
        .boss-countdown div span:first-child {
            font-size: 50px;
            font-weight: 700;
            color: #FFFFFF;
        }
        .boss-countdown div span {
            display: block;
            width: 240px;
        }
        .boss-countdown div span:last-child {
            font-size: 30px;
            line-height: 20px;
            border: 3px solid;
            padding: 15px 10px;
            margin: 20px auto 0px;
            width: 170px;
            text-transform: uppercase;
            font-weight: 300;
            color: #FFFFFF;
        }
        .boss-header h1 {
            padding: 0;
            font-weight: 700;
            font-size:50px;
            color:#2b542c;
        }
        .boss-header p{
            font-size: 16px;
            font-weight: 400;
            color: #FFFFFF;
        }
         /*-- firestatus --*/
        .firestatus h4,.services h4,.services1 h4,.advantages h4,.history-left h4,.history-right h4,.gallery h4,.contact h4,.newsletter-info h4{
            color:#2dcc70;
            margin:0;
            font-size:22px;
            padding-left: 0.7em;
            position:relative;
        }
        .firestatus h4:before,.services h4:before,.contact h4:before,.gallery h4:before,.services1 h4:before,.history-left h4:before,.history-right h4:before{
            content: '';
            height: 100%;
            position: absolute;
            top: 0%;
            left: 0%;
        }
        p.ever{
            margin:.5em 0 0;
            color:#999;
            font-size:14px;
            line-height:1.8em;
            padding-left:1em;
        }
        .firestatus-grd{
            border-radius: 170px;
            box-shadow: 0px 0px 5px #D8D8D8;
            padding: 1em 1em 0 1em;
            position: relative;
            min-height: 250px;
            transition:.5s all;
            -webkit-transition:.5s all;
            -moz-transition:.5s all;
            -o-transition:.5s all;
            -ms-transition:.5s all;
            margin-bottom: 100px;
        }
        .firestatus-grid:hover div.firestatus-grd{
            transform: rotateY(360deg);
            -webkit-transform: rotateY(360deg);
            -o-transform: rotateY(360deg);
            -ms-transform: rotateY(360deg);
            -moz-transform: rotateY(360deg);
            transition: 0.5s all ease;
            -webkit-transition: 0.5s all ease;
            -moz-transition: 0.5s all ease;
            -o-transition: 0.5s all ease;
            -ms-transition: 0.5s all ease;
        }
        .firestatus-grd:hover{
            box-shadow: 0px 0px 5px #2dcc70;
        }
        .firestatus-grd:hover div.icons{
            background:#999;
        }
        .firestatus-grd h4{
            text-transform:capitalize;
            font-size:1.3em;
            color:#2dcc70;
            margin:2.5em 0 1em;
            text-align:center;
        }
        .firestatus-grd p{
            margin:0;
            color:#999;
            font-size:14px;
            text-align:center;
            line-height:1.8em;
            margin-top: 30px;
        }
        .fire-control{
            margin-left: 20px;
        }
        .icons{
            width:70px;
            height:70px;
            background:#34495e;
            margin:0 auto;
            border-radius:60px;
            -webkit-border-radius:60px;
            -moz-border-radius:60px;
            -o-border-radius:60px;
            -ms-border-radius:60px;
            position:absolute;
            top: -10%;
            left: 37%;
        }
        .icons span{
            color: #fff;
            font-size: 1.3em;
            left: 1.1em;
            top: 1em;
        }
        .firestatus-grids{
            margin:6em 0 0;
        }
        /*-- //firestatus --*/
        .error-reminder{
            color: #ad1514;
        }

        #box-alarm {
            width: 200px;
            overflow: hidden;
        }
        .animate {
            padding-left: 20px;
            font-size: 12px;
            color: #e50f29;
            display: inline-block;
            white-space: nowrap;
            animation: 5s wordsLoop linear infinite normal;
        }
        @keyframes wordsLoop {
            0% {
                transform: translateX(200px);
                -webkit-transform: translateX(200px);
            }
            100% {
                transform: translateX(-100%);
                -webkit-transform: translateX(-100%);
            }
        }
        @-webkit-keyframes wordsLoop {
            0% {
                transform: translateX(200px);
                -webkit-transform: translateX(200px);
            }
            100% {
                transform: translateX(-100%);
                -webkit-transform: translateX(-100%);
            }
        }
    </style>
</head>
<script>
    function showDiv(var1){
        objId='list-'+var1;
        var objDiv=document.getElementById(objId);
        var objDiv1=document.getElementById("list-1");
        var objDiv2=document.getElementById("list-2");
        var objDiv3=document.getElementById("list-3");
        var objDiv4=document.getElementById("list-4");
        var objDiv5=document.getElementById("list-5");
        var objDiv6=document.getElementById("list-6");
        objDiv1.style.display="none";
        objDiv2.style.display="none";
        objDiv3.style.display="none";
        objDiv4.style.display="none";
        objDiv5.style.display="none";
        objDiv6.style.display="none";
        objDiv.style.display="block";
    }
    var flag1=0,flag2=0,flag3=0,flag4=0;
    var flags1=2,flags2=2,flags3=2,flagrs1=2,flagrs2=2,flagrs3=2,flagcl=2,flagcls=2;

    /*******************************历史数据变量***************************************/
    //时间数组
    var time = [];
    //温度历史数据
    var tmpHis = [];
    //湿度历史数据
    var humidityHis = [];
    //pm2.5历史数据
    var pmHis = [];
    //紫外线历史数据
    var uvHis = [];
    //异常日志
    var alarm = [];
    /********************************************************************************/

    {% comment %}
    flag1为获取实时数据的定时器
    flag2为获取执行器实时状态的定时器
    flag3为获取报警信息的定时器
    {% endcomment %}
    {#    导航栏控制显示Div   #}
    {# 获取实时数据 #}
    function getrealtimedata(){
        $.ajax({
            type:"GET",
            url: '/current/present/',
            dataType:'json',
            success:function (data) {
                {# 返回的是'light','co2','tem','hum','ray','pm','envtem','envhum' #}
                $('#tem-show').text(data.tem+'℃');
                $('#hum-show').text(data.hum+'%');
                $('#pm-show').text(data.pm);
                $('#ray-show').text(data.ray);
                // 折线图添加数据

                deleteDataOrNot(true);
                //温度
                date.push(fnTime());
                 //温度
                tmpdata.push(data.tem);
                //CO2
                co2data.push(data.co2);
                //light
                intensitydata.push(data.light);

                tmpChart.setOption({
                    xAxis:{
                        data:date
                    },
                    series:[{
                        name:'成交',
                        data:tmpdata
                    }]
                });


                co2Chart.setOption({
                    xAxis:{
                        data:date
                    },
                    series:[{
                        name:'成交',
                        data:co2data
                    }]
                });

                intensityChart.setOption({
                    xAxis:{
                        data:date
                    },
                    series:[{
                        name:'成交',
                        data:intensitydata
                    }]
                });

                // 仪表盘获取数据
                co2 = data.co2;
                lightintensity = data.light;
                indoortmp = data.envtem;
                indoorhumidty = data.envhum;

                $('#CO2').html('');
                $('#light-intensity').html(null);
                $('#indoor-tmp').html('');
                $('#indoor-humidity').html('');

                var co2Gage = new JustGage({
                    id: "CO2",
                    value: co2,
                    min: 0,
                    max: 5000,
                    width:1000,
                    gaugeColor:"#ededed",
                    valueFontColor:"#02678f",
                    gaugeWidthScale:0.35,
                    title: "CO2浓度"
                });
                var lightGage = new JustGage({
                    id: "light-intensity",
                    value: lightintensity,
                    min: 0,
                    max: 1000,
                    gaugeColor:"#ededed",
                    valueFontColor:"#913936",
                    gaugeWidthScale:0.35,
                    title: "室内光强"
                });
                var tmpGage = new JustGage({
                    id: "indoor-tmp",
                    value: indoortmp,
                    min: 10,
                    max: 35,
                    gaugeColor:"#ededed",
                    valueFontColor:"#006b58",
                    gaugeWidthScale:0.35,
                    title: "室内温度"
                });
                var humidityGage = new JustGage({
                    id: "indoor-humidity",
                    value: indoorhumidty,
                    min: 0,
                    max: 100,
                    gaugeColor:"#ededed",
                    valueFontColor:"#684c8b",
                    gaugeWidthScale:0.35,
                    title: "室内湿度"
                });



            },
            error:function () {
                console.log("获取实时数据失败");
                 deleteDataOrNot(true);
                //温度
                date.push(fnTime());
                 //温度
                tmpdata.push(12);
                //CO2
                co2data.push(23);
                //ght
                intensitydata.push(89);

                tmpChart.setOption({
                    xAxis:{
                        data:date
                    },
                    series:[{
                        name:'成交',
                        data:tmpdata
                    }]
                });


                co2Chart.setOption({
                    xAxis:{
                        data:date
                    },
                    series:[{
                        name:'成交',
                        data:co2data
                    }]
                });

                intensityChart.setOption({
                    xAxis:{
                        data:date
                    },
                    series:[{
                        name:'成交',
                        data:intensitydata
                    }]
                });

            }
        });
    }
    {# 获取执行器状态 #}
    function getexecuterstate() {
        $.ajax({
            type:"GET",
            url: '/current/execute/',
            dataType:'json',
            success:function (data) {
                if(data.fan=='1'){
                    flags1=1;
                    $('[name="status1"]').bootstrapSwitch('state', true);
                    flags1=2;
                }else{
                    flags1=1;
                    $('[name="status1"]').bootstrapSwitch('state', false);
                    flags1=2;
                }
                if(data.curtain=='1'){
                    flags2=1;
                    $('[name="status2"]').bootstrapSwitch('state', true);
                    flags2=2;
                }else{
                    flags2=1;
                    $('[name="status2"]').bootstrapSwitch('state', false);
                    flags2=2;
                }
                {# 正常1 备用2 #}
                if(data.power=='1'){
                    flags3=1;
                    $('[name="status3"]').bootstrapSwitch('state', true);
                    flags3=2;
                }else{
                    flags3=1;
                    $('[name="status3"]').bootstrapSwitch('state', false);
                    flags3=2;
                }
                if(data.led1=='1'){
                    if($('[name="status-room-1"]').bootstrapSwitch('state')==false){

                        flagcls=1;
                        $('[name="status-room-1"]').bootstrapSwitch('state', true);
                        $('#ex1').slider('setValue',50);
                        flagcls=2;
                    }

                }else{
                    flagrs1=1;
                    $('[name="status-room-1"]').bootstrapSwitch('state', false);
                    flagrs1=2;
                }
                if(data.led2=='1'){
                    if($('[name="status-room-2"]').bootstrapSwitch('state')==false){
                        flagcls=1;
                        $('[name="status-room-2"]').bootstrapSwitch('state', true);
                        $('#ex2').slider('setValue',50);
                        flagcls=2;
                    }
                }else{
                    flagrs2=1;
                    $('[name="status-room-2"]').bootstrapSwitch('state', false);
                    flagrs2=2;
                }
                if(data.led3=='1'){
                    if($('[name="status-room-3"]').bootstrapSwitch('state')==false){
                        flagcls=1;
                        $('[name="status-room-3"]').bootstrapSwitch('state', true);
                        $('#ex3').slider('setValue',50);
                        flagcls=2;
                    }
                }else{
                    flagrs3=1;
                    $('[name="status-room-3"]').bootstrapSwitch('state', false);
                    flagrs3=2;
                }
                if(data.fcled!=$("option:selected",this).val()){
                    switch(data.fcled){
                        case 0:
                            flagcl=1;
                            $("#colorlightchoose").find("option[value='4']").attr("selected",true);
                            flagcl=2;
                            break;
                        case 1:
                            flagcl=1;
                            $("#colorlightchoose").find("option[value='1']").attr("selected",true);
                            flagcl=2;
                            break;
                        case 2:
                            flagcl=1;
                            $("#colorlightchoose").find("option[value='2']").attr("selected",true);
                            flagcl=2;
                            break;
                        case 3:
                            flagcl=1;
                            $("#colorlightchoose").find("option[value='3']").attr("selected",true);
                            flagcl=2;
                            break;
                    }
                }
            },
            error:function () {
                console.log("获取执行器状态失败");
            }
        });
    }
    {# 控制风扇、电源、窗帘的开闭 #}
    function setswitch(var1,var2){
        {# var1为type,var2为开关（0和1） #}
        {# 设置fan，curtain，power的开关 #}
        {# power的开为2，关为1 #}
        $.ajax({
            type:"POST",
            url: '/performer/switch/',
            data:{
                type:var1,
                on_off:var2
            },
            dataType:'json',
            success:function (data) {
                if(data.res=='1'){
                    console.log("开关操作成功");
                }
            },
            error:function () {
                alert("操作失败");
            }
        });
    }
    {# 控制彩灯 #}
    function setcolorlight(var1){
        {# type为自定义的类型 1,2,3#}
        {# 设置彩灯#}
        $.ajax({
            type:"POST",
            url: '/performer/light/',
            data:{
                type:var1
            },
            dataType:'json',
            success:function (data) {
                if(data.res=='1'){
                    console.log("彩灯操作成功");
                }
            },
            error:function () {
                alert("操作失败");
            }
        });
    }
    {# 控制门 #}
    function setgate(var1){
        {# type为school，park #}
        {# 学校大门和停车场大门的控制#}
        $.ajax({
            type:"POST",
            url: '/performer/gate/',
            data:{
                type:var1
            },
            dataType:'json',
            success:function (data) {
                if(data.res=='1'){
                    console.log("大门操作成功");
                }
            },
            error:function () {
                alert("操作失败");
            }
        });
    }
    {# 设置教室照明灯的开关 #}
    function setlights(var1,var2,var3){
        {# 教室照明灯  classroom为1，2，3 #}
        {# classroom	on_off(0关，1开）	bright#}
        $.ajax({
            type:"POST",
            url: '/performer/lights/',
            data:{
                classroom:var1,
                on_off:var2,
                bright:var3
            },
            dataType:'json',
            success:function (data) {
                if(data.res=='1'){
                    console.log("照明灯操作成功");
                }
            },
            error:function () {
                alert("操作失败");
            }
        });
    }
     {# 在安防系统查询一个用户的门禁记录 #}
    function getguardinfo(var1,var2,var3){
        {# 在安防系统查询一个用户的门禁记录 #}
        {# username，arrive_date,leave_date #}
        $.post('/history/security/',
                {
                    'login_id':var1,
                    'start_date':var2,
                    'end_date':var3
                },
                function (res) {
                    $("#secu-result").empty();
                    $("#secu-result").append(res);
                }
            );
    }
    {# 获取历史数据 #}
    function gethistorydata() {

        {# 获取历史数据 #}
        {# 选择获取 #}
        $.ajax({
            type:"GET",
            url:'/history/',
            dataType:'json',
            success:function (data) {
                //四个图表的数据
                time.splice(0, time.length);
                tmpHis.splice(0, tmpHis.length);
                humidityHis.splice(0, humidityHis.length);
                pmHis.splice(0, pmHis.length);
                uvHis.splice(0, uvHis.length);
                $('#abnormal').html('');

                var datas = data.datas;
                for(var i = 0; i < datas.length; i++){
                    //四个传感器 每个传感器就是datas[i]
                    switch(datas[i].type){
                        case 'tem':
                            var tmpData = datas[i].data;
                            break;
                        case 'hum':
                            var humidityData = datas[i].data;
                            break;
                        case 'pm':
                            var pmData = datas[i].data;
                            break;
                        case 'ray':
                            var uvData = datas[i].data;
                            break;
                    }
                }

                //温度
                for(var i = 0; i < tmpData.length; i++){
                    var j = 0;
                    while(j < tmpData[i].data.length - 1){
                        tmpHis.push(tmpData[i].data[j]);
                        time.push('-');
                        j++;
                    }
                    tmpHis.push(tmpData[i].data[j]);
                    time.push(tmpData[i].time);
                }
                //console.log(tmpHis);
                //console.log(time);
                //湿度
                for(var i = 0; i < humidityData.length; i++){
                    for(var j = 0; j < humidityData[i].data.length; j++){
                        humidityHis.push(humidityData[i].data[j]);
                    }
                }
                //pm2.5
                for(var i = 0; i < pmData.length; i++){
                    for(var j = 0; j < pmData[i].data.length; j++){
                        pmHis.push(pmData[i].data[j]);
                    }
                }
                //紫外线
                for(var i = 0; i < uvData.length; i++){
                    for(var j = 0; j < uvData[i].data.length; j++){
                        uvHis.push(uvData[i].data[j]);
                    }
                }

                //'alarm':[{'time':'2018-2','type':'火灾','sensor':'火警'}]
                //异常日志的数据
                alarm = data.alarm;

                for(var i = 0;i < alarm.length; i++){ //遍历一下json数据
                    alarm[i].id = '#00'+(i+1);
                }
                var tbody = document.getElementById('abnormal');
                for(var i = 0;i < alarm.length; i++){ //遍历一下json数据
                    var trow = getDataRow(alarm[i]); //定义一个方法,返回tr数据
                    tbody.appendChild(trow);
                }

                var tmpHistory = echarts.init(document.getElementById('tmpHistory'));
                option1 = {
                    title: {
                        text: '温度'
                    },
                    tooltip: {
                        trigger: 'axis'
                    },
                    grid: {
                        left: '5%',
                        right: '10%',
                        bottom: '20%',
                        containLabel: true
                    },
                    color: ['#c23531'],
                    xAxis: {
                        type: 'category',
                        axisLabel:{
    		                interval: 0
    	                },
                        boundaryGap: false,
                        data: time,
                        axisLine:{
                            lineStyle: {
                                type : 'solid',
                                color : '#666'
                            },
                        }
                    },
                    yAxis: {
                        zlevel: 0,
                        type: 'value',
                        axisLine : {
                            show : false,
                            lineStyle:{
                                color:'#dfe3e3'
                            }
                        },
                        axisTick : {
                            show : false
                        },
                        boundaryGap: ['20%', '20%'],
                        scale : false,
                        min : 0,
                        type : 'value',
                        splitLine : {
                            lineStyle : {
                                type : 'dotted'
                            }
                        }
                    },
                    series: [
                        {
                            name:'温度',
                            type:'line',
                            stack: '分数',
                            lineStyle: {
                                normal: {
                                    width: 1
                                }
                            },
                            data:tmpHis
                        },
                    ]
                };

                // 湿度历史数据
                var humidityHistory = echarts.init(document.getElementById('humidityHistory'));
                option2 = {
                    title: {
                        text: '湿度'
                    },
                    tooltip: {
                        trigger: 'axis'
                    },
                    grid: {
                        left: '5%',
                        right: '10%',
                        bottom: '20%',
                        containLabel: true
                    },
                    color: ['#c23531'],
                    xAxis: {
                        type: 'category',
                        axisLabel:{
    		                interval: 0
    	                },
                        boundaryGap: false,
                        data: time,
                        axisLine:{
                            lineStyle: {
                                type : 'solid',
                                color : '#666'
                            },
                        }
                    },
                    yAxis: {
                        zlevel: 0,
                        type: 'value',
                        axisLine : {
                            show : false,
                            lineStyle:{
                                color:'#dfe3e3'
                            }
                        },
                        axisTick : {
                            show : false
                        },
                        boundaryGap: ['20%', '20%'],
                        scale : false,
                        min : 0,
                        type : 'value',
                        splitLine : {
                            lineStyle : {
                                type : 'dotted'
                            }
                        }
                    },
                    series: [
                        {
                            name:'湿度',
                            type:'line',
                            stack: '分数',
                            lineStyle: {
                                normal: {
                                    width: 1
                                }
                            },
                            data:humidityHis
                        },
                    ]
                };


                //PM2.5折线图
                var pm25History = echarts.init(document.getElementById('pm25History'));
                option3 = {
                    title: {
                        text: 'PM2.5'
                    },
                    tooltip: {
                        trigger: 'axis'
                    },
                    grid: {
                        left: '5%',
                        right: '10%',
                        bottom: '20%',
                        containLabel: true
                    },
                    color: ['#c23531'],
                    xAxis: {
                        type: 'category',
                        axisLabel:{
    		                interval: 0
    	                },
                        boundaryGap: false,
                        data: time,
                        axisLine:{
                            lineStyle: {
                                type : 'solid',
                                color : '#666'
                            },
                        }
                    },
                    yAxis: {
                        zlevel: 0,
                        type: 'value',
                        axisLine : {
                            show : false,
                            lineStyle:{
                                color:'#dfe3e3'
                            }
                        },
                        axisTick : {
                            show : false
                        },
                        boundaryGap: ['20%', '20%'],
                        scale : false,
                        min : 0,
                        type : 'value',
                        splitLine : {
                            lineStyle : {
                                type : 'dotted'
                            }
                        }
                    },
                    series: [
                        {
                            name:'PM2.5',
                            type:'line',
                            stack: '分数',
                            lineStyle: {
                                normal: {
                                    width: 1
                                }
                            },
                            data:pmHis
                        },
                    ]
                };

                //UV折线图
                var uvHistory = echarts.init(document.getElementById('uvHistory'));
                option4 = {
                    title: {
                        text: '紫外线'
                    },
                    tooltip: {
                        trigger: 'axis'
                    },
                    grid: {
                        left: '5%',
                        right: '10%',
                        bottom: '20%',
                        containLabel: true
                    },
                    color: ['#c23531'],
                    xAxis: {
                        type: 'category',
                        axisLabel:{
    		                interval: 0
    	                },
                        boundaryGap: false,
                        data: time,
                        axisLine:{
                            lineStyle: {
                                type : 'solid',
                                color : '#666'
                            },
                        }
                    },
                    yAxis: {
                        zlevel: 0,
                        type: 'value',
                        axisLine : {
                            show : false,
                            lineStyle:{
                                color:'#dfe3e3'
                            }
                        },
                        axisTick : {
                            show : false
                        },
                        boundaryGap: ['20%', '20%'],
                        scale : false,
                        min : 0,
                        type : 'value',
                        splitLine : {
                            lineStyle : {
                                type : 'dotted'
                            }
                        }
                    },
                    series: [
                        {
                            name:'UV',
                            type:'line',
                            stack: '分数',
                            lineStyle: {
                                normal: {
                                    width: 1
                                }
                            },
                            data:uvHis
                        },
                    ]
                };

                tmpHistory.setOption(option1);
                window.onresize = tmpHistory.resize;
                humidityHistory.setOption(option2);
                pm25History.setOption(option3);
                uvHistory.setOption(option4);

            },
            error:function () {
                console.log("获取历史数据失败！");


            }
        });
    }
    {# 查询功能 #}
    function queryall(var1,var2,var3) {
        {# 查询功能 #}
        {# search_type	start_date	end_date#}
        $.post('/search/type/',
                {
                    'search_type':var1,
                    'start_date':var2,
                    'end_date':var3
                },
                function (res) {
                    $("#search-result").empty();
                    $("#search-result").append(res);
                }
            );
    }
    {# 根据传感器查询历史数据 #}
    function querysensordata(var1,var2,var3) {
        {# 根据传感器查询历史数据 #}
        {# sensor_type	start_date	end_date #}
        $.post('/history/sensor/',
                {
                    'sensor_type':var1,
                    'start_date':var2,
                    'end_date':var3
                },
                function (res) {
                    $("#search-result-sen").empty();
                    $("#search-result-sen").append(res);
                }
            );
    }
    {# 手动关闭消防和安防的报警 #}
    function setalarm(var1) {
        {# 手动关闭消防和安防的报警 #}
        {# type：fire1，guard2 #}
        $.ajax({
            type:"POST",
            url:'/performer/alarm/',
            data:{
               type:var1
            },
            dataType:'json',
            success:function (data) {
                if(data.res=='1'){
                    alert("关闭成功");
                }
            },
            error:function () {
                alert("操作失败");
            }
        });
    }
    {# 安防报警 #}
    function alarm(){
        document.getElementById("set-status").innerHTML='异常';
        document.getElementById("guard-alarm").setAttribute('class','alarm-color');
        document.getElementById("security-pic").style.display='none';
        document.getElementById("unsecurity-pic").style.display = 'block';
        document.getElementById("box-alarm").style.display='block';
        document.getElementById("alarm-pic").style.display='block';
        document.getElementById("box-alarm-p").innerHTML="请注意，安防报警啦！";
    }
    {# 关闭安防报警 #}
    function closealarm(){
        setalarm(2);
        document.getElementById("set-status").innerHTML='正常';
        document.getElementById("guard-alarm").setAttribute('class','normal-color');
        document.getElementById("box-alarm").style.display='none';
        document.getElementById("alarm-pic").style.display='none';
        document.getElementById("security-pic").style.display='block';
        document.getElementById("unsecurity-pic").style.display = 'none';
    }
    {# 火灾报警 #}
    function firealarm(){
        document.getElementById("fire-alarm").innerHTML='用户请注意，发生火灾警报！';
        document.getElementById("fire-alarm").style.color='#e50f29';
        document.getElementById("box-alarm").style.display='block';
        document.getElementById("alarm-pic").style.display='block';
        document.getElementById("box-alarm-p").innerHTML="请注意，火灾报警啦！";
{#        document.getElementById("fire-alarm-btn").href="javascript:closefirealarm();";#}
    }
    {# 关闭火灾报警 #}
    function closefirealarm(){
        setalarm(1);
        document.getElementById("fire-alarm").innerHTML='一切正常，未发生火灾警报！';
        document.getElementById("fire-alarm").style.color='#3f4041';
        document.getElementById("fire-status").style.color='#3f4041';
        document.getElementById("ch4-status").style.color='#3f4041';
        document.getElementById("smoke-status").style.color='#3f4041';
        document.getElementById("ray-status").style.color='#3f4041';
        document.getElementById("fire-status1").style.color='#3f4041';
        document.getElementById("ch4-status1").style.color='#3f4041';
        document.getElementById("smoke-status1").style.color='#3f4041';
        document.getElementById("ray-status1").style.color='#3f4041';
        document.getElementById("ch4-status").innerHTML='甲烷浓度低于安全阈值';
        document.getElementById("fire-status").innerHTML='火光亮度低于安全阈值';
        document.getElementById("smoke-status").innerHTML='烟雾浓度低于安全阈值';
        document.getElementById("ray-status").innerHTML='红外线强度低于安全阈值';
        document.getElementById("ch4-status1").innerHTML='无火灾隐患';
        document.getElementById("fire-status1").innerHTML='无火灾隐患';
        document.getElementById("smoke-status1").innerHTML='无火灾隐患';
        document.getElementById("ray-status1").innerHTML='无火灾隐患';
        document.getElementById('ch4-status1').style.fontWeight='normal';
        document.getElementById('fire-status1').style.fontWeight='normal';
        document.getElementById('smoke-status1').style.fontWeight='normal';
        document.getElementById('ray-status1').style.fontWeight='normal';
        document.getElementById("box-alarm").style.display='none';
        document.getElementById("alarm-pic").style.display='none';
        {#        document.getElementById("fire-alarm-btn").href="javascript:firealarm();";#}
    }
     {# 获取报警，定时器 #}
    function getalarm(){
        {# 获取报警，定时器 #}
        $.ajax({
            type:"GET",
            url:'/current/fire/',
            dataType:'json',
            success:function (data) {
                if(data.alarm_type=='2'){
                    if(data.sensor_id=='5'||data.sensor_id=='6'){
                        {#                        alarm();#}
                        document.getElementById("set-status").innerHTML='异常';
                        document.getElementById("guard-alarm").setAttribute('class','alarm-color');
                        document.getElementById("security-pic").style.display='none';
                        document.getElementById("unsecurity-pic").style.display = 'block';
                        document.getElementById("box-alarm").style.display='block';
                        document.getElementById("alarm-pic").style.display='block';
                        document.getElementById("box-alarm-p").innerHTML="请注意，安防报警啦！";
                    }
                }
                if(data.alarm_type=='1'){
                    firealarm();
                    switch(data.sensor_id){
                        case 1:
                            document.getElementById('ch4-status').innerHTML='甲烷浓度高于阈值';{# 甲烷异常 #}
                            document.getElementById('ch4-status').style.color='#e50f29';
                            document.getElementById('ch4-status1').style.color='#e50f29';
                            document.getElementById('ch4-status1').innerHTML='处于火灾警报状态';
                            document.getElementById('fire-status1').innerHTML='处于火灾警报状态';
                            document.getElementById('smoke-status1').innerHTML='处于火灾警报状态';
                            document.getElementById('ray-status1').innerHTML='处于火灾警报状态';
                            break;
                        case 2:
                            document.getElementById('fire-status').innerHTML='火光亮度高于阈值';{# 火光异常 #}
                            document.getElementById('fire-status').style.color='#e50f29';
                            document.getElementById('fire-status1').style.color='#e50f29';
                            document.getElementById('ch4-status1').innerHTML='处于火灾警报状态';
                            document.getElementById('fire-status1').innerHTML='处于火灾警报状态';
                            document.getElementById('smoke-status1').innerHTML='处于火灾警报状态';
                            document.getElementById('ray-status1').innerHTML='处于火灾警报状态';
                            break;
                        case 3:
                            document.getElementById('smoke-status').innerHTML='烟雾浓度高于阈值'; {# 烟雾异常 #}
                            document.getElementById('smoke-status').style.color='#e50f29';
                            document.getElementById('smoke-status1').style.color='#e50f29';
                            document.getElementById('ch4-status1').innerHTML='处于火灾警报状态';
                            document.getElementById('fire-status1').innerHTML='处于火灾警报状态';
                            document.getElementById('smoke-status1').innerHTML='处于火灾警报状态';
                            document.getElementById('ray-status1').innerHTML='处于火灾警报状态';
                            break;
                        case 4:
                            document.getElementById('ray-status').innerHTML='红外线强度高于阈值';{# 红外异常 #}
                            document.getElementById('ray-status').style.color='#e50f29';
                            document.getElementById('ray-status1').style.color='#e50f29';
                            document.getElementById('ch4-status1').innerHTML='处于火灾警报状态';
                            document.getElementById('fire-status1').innerHTML='处于火灾警报状态';
                            document.getElementById('smoke-status1').innerHTML='处于火灾警报状态';
                            document.getElementById('ray-status1').innerHTML='处于火灾警报状态';
                            break;
                    }
                }
            },
            error:function () {
                console.log("获取报警信息失败");
            }
        });
    }

    {# 安防系统查询触发函数 #}
    function searchentrance(){
        var name = $('input[name="secu-user"]').val();
        var start =$('input[name="starttime"]').val();
        var end =$('input[name="endtime"]').val();
        if(!start||!end){
            $('#search-entr-reminder').empty();
            $('#search-entr-reminder').append("开始时间和结束时间输入内容不能为空")
        }else {
            $('#search-entr-reminder').empty();
            getguardinfo(name, start, end);
        }
    }
    {# 查询功能历史记录查询触发函数 #}
    function searchhistoryrecord(){
        var type = $('#searchtype').find("option:selected").val();
        var start = $('input[name="starttime_a"]').val();
        var end = $('input[name="endtime_a"]').val();
        if(!start||!end){
            $('#search-type-reminder').empty();
            $('#search-type-reminder').append("输入内容不能为空")
        }else{
            $('#search-type-reminder').empty();
            queryall(type,start,end);
        }
    }
    {# 查询单个传感器数据 #}
    function searchsensorrecord(){
        var type = $('#select-sensor').find("option:selected").val();
        var start = $('input[name="starttime_sen"]').val();
        var end = $('input[name="endtime_sen"]').val();
         if(!start||!end){
            $('#search-sen-reminder').empty();
            $('#search-sen-reminder').append("输入内容不能为空")
         }else{
             $('#search-sen-reminder').empty();
             querysensordata(type,start,end);
         }
    }
    function fingerprint(var1){
        $.ajax({
            type:"POST",
            url:'/performer/fingerprint/',
            data:{
               type:var1
            },
            dataType:'json',
            success:function (data) {
                if(data.res=='1'){
                    alert("操作成功");
                }
            },
            error:function () {
                alert("操作失败");
            }
        });
    }
    $(function () {
        {% comment %}
        la1:实时数据    la1-1:实时数据  la1-2:实时趋势
        la2:控制模块    la3:安防模块    la4:消防模块    la5:历史数据    la6:查询功能
        la6-1:历史记录  la6-2:单个传感器
        {% endcomment %}

        settodaydate();
        getrealtimedata();

        flag3 = setInterval(getalarm,3000);
        flag1 = setInterval(getrealtimedata,3000);
        $('#la1').click(function () {
            if(flag2!=0){
                clearInterval(flag2);
                flag2=0;
            }
            if(flag1==0){
                flag1 = setInterval(getrealtimedata,3000);
            }
        });
        $('#la1-1').click(function () {
            if(flag1==0){
                flag1 = setInterval(getrealtimedata,3000);
            }
        });
        $('#la1-2').click(function () {
            if(flag1==0){
                flag1 = setInterval(getrealtimedata,3000);
            }
        });
        $('#la2').click(function () {
            getexecuterstate();
            if(flag1!=0){
                clearInterval(flag1);
                flag1=0;
            }
            flag2 = setInterval(getexecuterstate,3000);
        })
        $('#la3').click(function () {
            if(flag1!=0){
                clearInterval(flag1);
                flag1=0;
            }
            if(flag2!=0){
                clearInterval(flag2);
                flag2=0;
            }
        })
        $('#la4').click(function () {
            if(flag1!=0){
                clearInterval(flag1);
                flag1=0;
            }
            if(flag2!=0){
                clearInterval(flag2);
                flag2=0;
            }
        })
        $('#la5').click(function () {
            if(flag1!=0){
                clearInterval(flag1);
                flag1=0;
            }
            if(flag2!=0){
                clearInterval(flag2);
                flag2=0;
            }
            gethistorydata();
        })
        $('#la6').click(function () {
            if(flag1!=0){
                clearInterval(flag1);
                flag1=0;
            }
            if(flag2!=0){
                clearInterval(flag2);
                flag2=0;
            }
        })
        $('#la6-1').click(function () {
            clearInterval(flag1);
            flag1=0;
        });
        $('#la6-2').click(function () {
            clearInterval(flag1);
        });
        $('#colorlightchoose').on("change",function(){
            var type=$("option:selected",this).val();
            if(flagcl==2){
                switch(type){
                    case '1':
                        setcolorlight(1);
                        break;
                    case '2':
                        setcolorlight(2);
                        break;
                    case '3':
                        setcolorlight(3);
                        break;
                    case '4':
                        setcolorlight(0);
                        break;
                }
            }
        });
    });

    /* ***********************************动态更新表格********************************/
    function getDataRow(h){
         var row = document.createElement('tr'); //创建行

         var idCell = document.createElement('td'); //创建第一列id
         idCell.innerHTML = h.id; //填充数据
         row.appendChild(idCell); //加入行  ，下面类似

         var timeCell = document.createElement('td');//创建第2列日期
         timeCell.innerHTML = h.time;
         row.appendChild(timeCell);

         var typeCell = document.createElement('td');//创建第3列异常类型
         typeCell.innerHTML = h.type;
         row.appendChild(typeCell);

         var sensorCell = document.createElement('td');//创建第4列传感器
         sensorCell.innerHTML = h.sensor;
         row.appendChild(sensorCell);
         return row;
     }
    function jumpto() {
        location.href = '/login/';
    }
</script>
<body>
<!--横向导航栏-->
<nav class="navbar navbar-fixed-top navbar-transparent" role="navigation">
    <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header" style="">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
        <img src="{% static 'img/contactus/logoForward.png' %}" style="max-height: 65px; float: left; margin-left: 10%;margin-top:-5px">
    </div>
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav" >
            <li class="active"><a href="#">Home <span class="sr-only">(current)</span></a></li>
            <li><a href="#">Help</a></li>
            <li><img src="{% static '/img/alarm.svg' %}" style="width: 40px;height: 40px;display: none;" id="alarm-pic"></li>
            <li>
                <br>
                <div id="box-alarm" style="display: none;">
                    <p class="animate" id="box-alarm-p" style="font-size: 18px;">
                        报警啦！报警啦！报警啦！报警啦！
                    </p>
                </div>
            </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <a href="/login/logout/" class="btn btn-red">&emsp;注销&emsp;</a>
          <li><p style="font-size: 16px;margin-top: 22px;">欢迎您 ,</p></li>
         <li><a href="#" class="username" style="font-size: 16px;">{{ request.session.user_name }}!</a></li>
      </ul>
    </div><!-- /.navbar-collapse -->
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
<!--竖向导航栏-->
<div class="navbar-collapse nav-ver-my">
   <ul class="nav sub-nav">
       <li class="nav-li" >
            <a href="#systemSetting" onclick="showDiv('1')" class="nav-a nav-header collapsed" id="la1" data-toggle="collapse">
               <i class="fa fa-clock-o"></i>
               <span>实时数据</span>
               <span class="pull-right glyphicon glyphicon-chevron-toggle"></span>
           </a>
       </li>
       <ul id="systemSetting" class="nav sub-nav nav-list collapse secondmenu">
           <li class="nav-lis nav1" >
                <a href="#current-data" onclick="showDiv('1')" class="nav-a" id="la1-1">
                    <i class="fa fa-star"></i>
                    <span>实时数据</span>
                </a>
            </li>
            <li class="nav-lisb sub-nav nav1">
                <a href="#current-trend" onclick="showDiv('1')" class="nav-a" id="la1-2">
                    <i class="fa fa-star"></i>
                    <span>实时趋势</span>
                </a>
            </li>
       </ul>
        {% if request.session.auth != 1 %}
       <li class="nav-li">
            <a href="javascript:showDiv('2');" class="nav-a" id="la2" >
               <i class="fa fa-sort-amount-asc"></i>
               <span>控制模块</span>
           </a>
       </li>
        {% endif %}
       {% if request.session.auth == 3 %}
       <li class="nav-li">
            <a href="#" class="nav-a" id="la3" onclick="showDiv('3');">
               <i class="fa fa-bell"></i>
               <span>安防系统</span>
           </a>
       </li>
       <li class="nav-li">
            <a href="#" class="nav-a" id="la4" onclick="showDiv('4');">
               <i class="fa fa-fire"></i>
               <span>消防系统</span>
           </a>
       </li>
       {% endif %}
       <li class="nav-li">
            <a href="#" class="nav-a" id="la5" onclick="showDiv('5');">
               <i class="fa fa-bar-chart-o"></i>
               <span>历史数据</span>
           </a>
       </li>
        {% if request.session.auth != 1 %}
       <li class="nav-li" >
           <a href="#queryblock" onclick="showDiv('6')" class="nav-a nav-header collapsed" id="la6" data-toggle="collapse">
               <i class="fa fa-search"></i>
               <span>查询功能</span>
               <span class="pull-right glyphicon glyphicon-chevron-toggle"></span>
           </a>
       </li>
       <ul id="queryblock" class="nav nav-list collapse secondmenu">
           <li class="nav-lis nav1 sub-nav" >
                <a href="#" class="nav-a" onclick="showDiv('6')" id="la6-1">
                    <i class="fa fa-star"></i>
                    <span>历史记录</span>
                </a>
            </li>
            <li class="nav-lisb nav1 sub-nav">
                <a href="#sensor-search" class="nav-a" onclick="showDiv('6')" id="la6-2">
                    <i class="fa fa-star"></i>
                    <span>单个传感器数据</span>
                </a>
            </li>
       </ul>
        {% endif %}
   </ul>
</div>
<!--实时数据-->
<div class="container" id="list-1">
    <!--当前所在界面 小导航-->
    <div class="row third-nav">
        <div class="col-md-3">
            <ol class="current-page-nav breadcrumb">
                <li class="breadcrumb-item"><a href="#">主页</a></li>
                <li class="breadcrumb-item"><a href="#">实时数据</a></li>
                <li class="breadcrumb-item active">数据</li>
            </ol>
        </div>
    </div>
    <!--数据展示-->
    <div class="row display-figure" id="current-data">
        <form name="outdoor" id="outdoor" action="/" method="post">
            <div class="row outdoor-box">
          <div class="col-lg-3 col-6 outdoor-display">
            <!-- 温度-->
            <div class="small-box value-tmp">
              <div class="inner">
                <h3 id="tem-show">33</h3>

                <p>温度</p>
              </div>
              <div class="icon">
                <i class="ion ion-bag"></i>
              </div>
            </div>
          </div>
          <!-- ./col -->
          <div class="col-lg-3 col-6 outdoor-display">
            <!-- 湿度 -->
            <div class="small-box value-humidity">
              <div class="inner">
               <h3 id="hum-show">53</h3>

                <p>空气湿度</p>
              </div>
              <div class="icon">
                <i class="ion ion-stats-bars"></i>
              </div>
            </div>
          </div>
          <!-- ./col -->
          <div class="col-lg-3 col-6 outdoor-display">
            <!-- PM2.5 -->
            <div class="small-box value-pm25">
              <div class="inner">
                <h3 id="pm-show">10</h3>

                <p>P M 2.5</p>
              </div>
              <div class="icon">
                <i class="ion ion-person-add"></i>
              </div>
            </div>
          </div>
          <!-- ./col -->
          <div class="col-lg-3 col-6 outdoor-display">
            <!-- 紫外线指数 -->
            <div class="small-box value-uv">
              <div class="inner">
                <h3 id="ray-show">6</h3>

                <p>U V 指数</p>
              </div>
              <div class="icon">
                <i class="ion ion-pie-graph"></i>
              </div>
            </div>
          </div>
          <!-- ./col -->
        </div>
        </form>
    </div>

    <!--仪表盘 日历-->
    <section class="row">
        <!--仪表盘-->
        <div class="col-md-6" >
            <div class="row dash-board">

                <div class="col-md-6 style-feature" id="CO2" style="">
                    <form action="#">
                        <input type="text" class="value-display" name="CO2">
                    </form>
                </div>
                <div class="col-md-6 style-feature" id="light-intensity">
                    <form action="#">
                        <input type="text" class="value-display" name="light-intensity">
                    </form>
                </div>
                 </div>
            <div class="row dash-board">
                <div class="col-md-6 style-feature" id="indoor-tmp">
                    <form action="#">
                        <input type="text" class="value-display" name="indoor-tmp">
                    </form>

                </div>

                <div class="col-md-6 style-feature" id="indoor-humidity">
                    <form action="#">
                        <input type="text" class="value-display" name=indoor-humidity">
                    </form>

                </div>

            </div>
        </div>
        <!--日历-->
        <div class="col-md-5" style="float:right; margin-top: 100px; margin-right: 40px;">
            <div class="card bg-success-gradient">
              <div class="card-header no-border ui-sortable-handle" style="cursor: move;">

                <h3 class="card-title">
                  <i class="fa fa-calendar"></i>
                  Calendar
                </h3>
              </div>
              <!-- /.card-header -->
             <div class="card-body p-0">
                <!--The calendar -->
                <div id="calendar" style="width: 100%;height: 380px"><div class="datepicker datepicker-inline">
                    <div class="datepicker-days" style="display: block;">
                        <table class="table table-condensed">
                            <thead>
                            <tr style="height: 40px; margin-bottom: 30px">
                                <th colspan="5" class="datepicker-switch" >
                                    <span id="current-year" style="margin-left: 90px;">2018年</span>
                                    <span id="current-month">7月</span>
                                </th>
                            </tr>
                            <tr style="line-height: 60px">
                                <th class="dow">Su</th>
                                <th class="dow">Mo</th>
                                <th class="dow">Tu</th>
                                <th class="dow">We</th>
                                <th class="dow">Th</th>
                                <th class="dow">Fr</th>
                                <th class="dow">Sa</th>
                            </tr></thead><tbody>
                        <tr>
                            <td class="day" id="day-1">1</td>
                            <td class="day" id="day-2">2</td>
                            <td class="day" id="day-3">3</td>
                            <td class="day" id="day-4">4</td>
                            <td class="day" id="day-5">5</td>
                            <td class="day" id="day-6">6</td>
                            <td class="day" id="day-7">7</td>
                        </tr>
                        <tr>
                            <td class="day" id="day-11">8</td>
                            <td class="day" id="day-12">9</td>
                            <td class="day" id="day-13">10</td>
                            <td class="day" id="day-14">11</td>
                            <td class="day" id="day-15">12</td>
                            <td class="day" id="day-16">13</td>
                            <td class="day" id="day-17">14</td>
                        </tr>
                        <tr>
                            <td class="day" id="day-21">15</td>
                            <td class="day" id="day-22">16</td>
                            <td class="day" id="day-23">17</td>
                            <td class="day" id="day-24">18</td>
                            <td class="day" id="day-25">19</td>
                            <td class="day" id="day-26">20</td>
                            <td class="day" id="day-27">21</td>
                        </tr>
                        <tr>
                            <td class="day" id="day-31">22</td>
                            <td class="day" id="day-32">23</td>
                            <td class="day" id="day-33">24</td>
                            <td class="day" id="day-34">25</td>
                            <td class="day" id="day-35">26</td>
                            <td class="day" id="day-36">27</td>
                            <td class="day" id="day-37">28</td>
                        </tr>
                        <tr>
                            <td class="day" id="day-41">29</td>
                            <td class="day" id="day-42">30</td>
                            <td class="day" id="day-43">31</td>
                            <td class="day" id="day-44">1</td>
                            <td class="day" id="day-45">2</td>
                            <td class="day" id="day-46">3</td>
                            <td class="day" id="day-47">4</td>
                        </tr>
                        </tbody>
                    </table>
                    <script>
                        function settodaydate() {
                            var mytime=new Date();
                            var year=mytime.getFullYear();
                            document.getElementById('current-year').innerHTML=year+'年';
                            var month=mytime.getMonth()+1;
                            document.getElementById('current-month').innerHTML=month+'月';
                            var day=mytime.getDate();
                            var week=mytime.getDay();
                            var a1=parseInt(day/7)+1;
                            var falg_mb,flag_m,w1,w2,w3,loca,loac1;
                            var day_loca;
                            if(month<7&&month>1){
                                if(month%2==1){
                                    flag_mb=30;
                                    flag_m =31;
                                }else{
                                    flag_mb=31;
                                    flag_m =30;
                                }
                            }else if(month>8&&month<=12){
                                if(month%2==0){
                                    flag_mb=30;
                                    flag_m =31;
                                }else{
                                    flag_mb=31;
                                    flag_m =30;
                                }
                            }else if(month==7){
                                flag_mb=30;
                                flag_m =31;
                            }else if(month==8){
                                flag_mb=31;
                                flag_m =31;
                            }
                            if((year%100==0&&year%400==0)||(year%100!=0&&year%4==0)){
                                if(month==3){
                                    flag_mb=28;
                                    flag_m =30;
                                }
                                if(month==2){
                                    flag_mb=31;
                                    flag_m=28;
                                }
                            }else{
                                if(month==2){
                                    flag_mb=31;
                                    flag_m =29;
                                }
                                 if(month==3){
                                    flag_mb=29;
                                    flag_m =31;
                                }
                            }
                            {# 1号是周几 #}
                            w1=day%7-week;
                            {# 今天在第几行 #}
                            w2=parseInt((day-week)/7)+1;
                            {# 本月最后一天是周几 #}
                            w3=(flag_m-day+week+1)%7;
                            var b1=(w2-1)*10+week+1;
                            console.log('w3'+w3);
                            document.getElementById('day-'+b1).style.backgroundColor='#0b2341';
                            for(var i=1;i<=flag_m;i++){
                                loca=parseInt((i-1)/7);
                                if(loca==0){
                                    day_loca=w1+i-1;
                                }else{
                                    loca1=i%7;
                                    if(loca1==0){
                                        day_loca=loca*10+7;
                                    }else{
                                        day_loca=loca*10+loca1;
                                    }
                                }
                               document.getElementById('day-'+day_loca).innerHTML=i;
                            }
                            var j=0;
                            for(var i=w1;i>1;i--){
                                document.getElementById('day-'+i).innerHTML=flag_mb-j;
                                j++;
                            }
                            for(var i=1;i<=(7-w3);i++){
                                j=i+w3;
                               document.getElementById('day-4'+j).innerHTML=i;
                            }
                        }
                    </script>
                </div>
                </div>
                </div>
              </div>
              <!-- /.card-body -->
            </div>

        </div>
    </section>

    <!--数据折线图-->
    <div class="row figure-pic" id="current-trend">
        <div class="col-md-11 figure-pic-tmp style-feature">
            <div class=" figure-pic-header">
                <h3><i class="fa fa-bar-chart-o"></i> 室温</h3> <em>- Indoor Temperature </em>
                <button type="button" class="btn btn-link btn-help" data-original-title="" title=""><i class="fa fa-question-circle"></i></button>
                <div class="btn-group figure-pic-header-toolbar">
                    <a href="#" id="tour-focus" title="Focus" class="btn-borderless btn-focus"><i class="fa fa-eye"></i></a>
                    <a href="#" title="Expand/Collapse" class="btn-borderless btn-toggle-expand"><i class="fa fa-chevron-up"></i></a>
                    <a href="#" title="Remove" class="btn-borderless btn-remove"><i class="fa fa-times"></i></a>
                </div>
            </div>
            <div class="figure-pic-content" id="tmp-chart">
            </div>
        </div>

    </div>

    <!--数据折线图2 3-->
    <div class="row figure-pic">
        <div class="col-md-5 col-md-offset-1 figure-pic-left style-feature">
            <div class="figure-pic-header">
                <h3><i class="fa fa-bar-chart-o"></i> CO2浓度</h3> <em>- CO2 Concentration</em>
                <button type="button" class="btn btn-link btn-help" data-original-title="" title=""><i class="fa fa-question-circle"></i></button>
                <div class="btn-group figure-pic-header-toolbar">
                    <a href="#" id="tour-focus" title="Focus" class="btn-borderless btn-focus"><i class="fa fa-eye"></i></a>
                    <a href="#" title="Expand/Collapse" class="btn-borderless btn-toggle-expand"><i class="fa fa-chevron-up"></i></a>
                    <a href="#" title="Remove" class="btn-borderless btn-remove"><i class="fa fa-times"></i></a>
                </div>
            </div>
            <div class="figure-pic-content" id="co2-chart">
            </div>
        </div>

        <div class="col-md-5 col-md-offset-1 figure-pic-right style-feature">
            <div class="figure-pic-header">
                <h3><i class="fa fa-bar-chart-o"></i> 室内光强</h3> <em>- Indoor Light Intensity</em>
                <button type="button" class="btn btn-link btn-help" data-original-title="" title=""><i class="fa fa-question-circle"></i></button>
                <div class="btn-group figure-pic-header-toolbar">
                    <a href="#" id="tour-focus" title="Focus" class="btn-borderless btn-focus"><i class="fa fa-eye"></i></a>
                    <a href="#" title="Expand/Collapse" class="btn-borderless btn-toggle-expand"><i class="fa fa-chevron-up"></i></a>
                    <a href="#" title="Remove" class="btn-borderless btn-remove"><i class="fa fa-times"></i></a>
                </div>
            </div>
            <div class="figure-pic-content" id="intensity-chart">
            </div>
        </div>

    </div>
</div>
<!--控制模块-->
<div class="container control-container" id="list-2" style="display: none;">
    <div class="row">
        <div class="panel panel-default toggle panelMove panelClose panelRefresh" style="margin-left: 50px;margin-right: 50px;">
            <!-- Start .panel -->
            <div class="panel-heading" style="background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);">
                <h4 class="panel-title"><i class="fa fa-list"></i> Control</h4>
            </div>
            <div class="panel-body">
                <div class="todo-widget">
                    <div class="col-lg-6">
                        <h4 class="todo-period">Indoor</h4>
                        <ul class="todo-list" id="today">
                            <li class="todo-task-item">
                                <div class="todo-priority normal tip" style="float: left">
                                    <img src="{% static 'img/control/fan11.svg' %}" alt="automobile-bot"class="control-icon">
                                </div>
                                <div class="switch-container todo-category" style="float: right;">
                                    <input name="status1" type="checkbox" data-size="small">
                                </div>
                                <div class="todo-task-text">风扇开关控制</div>
                            </li>
                            <li class="todo-task-item">
                                <div class="todo-priority normal tip" style="float: left">
                                    <img src="{% static 'img/control/curtains11.svg' %}" alt="automobile-bot" class="control-icon">
                                </div>
                                <div class="switch-container todo-category" style="float: right">
                                    <input name="status2" type="checkbox" data-size="small">
                                </div>
                                <div class="todo-task-text">窗帘开关控制</div>
                            </li>
                             <h5 class="todo-period">室内照明灯</h5>
                            <div id="light-reminder" class="error-reminder"></div>
                            <li class="todo-task-item">
                                <div class="todo-priority normal tip" style="float: left">
                                    <img src="{% static 'img/control/light-bulb.svg' %}" alt="automobile-bot" class="control-icon">
                                </div>
                                <div class="switch-container todo-category" style="float: right;">
                                    <input id="ex1" data-slider-id='ex1Slider' type="text" data-slider-min="0" data-slider-max="100" data-slider-step="10" data-slider-value="0" style="width: 120px;"/>
                                    <input name="status-room-1" type="checkbox" data-size="small"><br>
                                </div>
                                <div class="todo-task-text">教室1照明灯控制</div>
                            </li>
                            <li class="todo-task-item">
                                <div class="todo-priority normal tip" style="float: left">
                                    <img src="{% static 'img/control/light-bulb1.svg' %}" alt="automobile-bot" class="control-icon">
                                </div>
                                <div class="switch-container todo-category" style="float: right">
                                    <input id="ex2" data-slider-id='ex1Slider' type="text" data-slider-min="0" data-slider-max="100" data-slider-step="10" data-slider-value="0" style="width: 120px;"/>
                                    <input name="status-room-2" type="checkbox" data-size="small"><br>
                                </div>
                                <div class="todo-task-text">教室2照明灯控制</div>
                            </li>
                            <li class="todo-task-item">
                                <div class="todo-priority normal tip" style="float: left">
                                    <img src="{% static 'img/control/light-bulb2.svg' %}" alt="automobile-bot" class="control-icon">
                                </div>
                                <div class="switch-container todo-category" style="float: right">
                                    <input id="ex3" data-slider-id='ex1Slider' type="text" data-slider-min="0" data-slider-max="100" data-slider-step="10" data-slider-value="0" style="width: 120px;"/>
                                    <input name="status-room-3" type="checkbox" data-size="small"><br>
                                </div>
                                <div class="todo-task-text">教室3照明灯控制</div>
                            </li>
                        </ul>
                    </div>
                    <div class="col-lg-6">
                        <h4 class="todo-period">Outdoor</h4>
                        <ul class="todo-list" id="tomorrow">
                            <li class="todo-task-item">
                                <div class="todo-priority normal tip" style="float: left">
                                    <img src="{% static 'img/control/green-energy.svg' %}" alt="automobile-bot" class="control-icon">
                                </div>
                                <div class="switch-container todo-category" style="float: right;">
                                    <input name="status3" type="checkbox" data-size="small">
                                </div>
                                <div class="todo-task-text">电源切换开关控制</div>
                            </li>
                            <li class="todo-task-item">
                                <div class="todo-priority normal tip" style="float: left">
                                    <img src="{% static 'img/control/lights11.svg' %}" alt="automobile-bot" class="control-icon">
                                </div>
                                <div class="switch-container todo-category" style="float: right;">
                                    <div class="form-group" style="width:100px;margin-left: 80px;">
                                        <select class="form-control" id="colorlightchoose">
                                            <option value="4" id="closecolorlight">关闭</option>
                                            <option value="1" id="colorlight1">红灯强</option>
                                            <option value="2" id="colorlight2">绿灯强</option>
                                            <option value="3" id="colorlight3">黄灯强</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="todo-task-text">室外炫彩灯控制</div>
                            </li>
                            <h5 class="todo-period">安防控制</h5>
                            <li class="todo-task-item">
                                <div class="todo-priority normal tip" style="float: left">
                                    <img src="{% static 'img/control/gate11.svg' %}" alt="automobile-bot" class="control-icon">
                                </div>
                                <div class="switch-container todo-category" style="float: right;">
                                    <button class="btn btn-primary" onclick="setgate('school')" style="width: 90px;">开启</button>
                                </div>
                                <div class="todo-task-text">学校大门开关控制</div>
                            </li>
                            <li class="todo-task-item">
                                <div class="todo-priority normal tip" style="float: left">
                                    <img src="{% static 'img/control/park11.svg' %}" alt="automobile-bot" class="control-icon">
                                </div>
                                <div class="switch-container todo-category" style="float: right;">
                                    <button class="btn btn-primary" onclick="setgate('park')" style="width: 90px;">开启</button>
                                </div>
                                <div class="todo-task-text">停车场大门开关控制</div>
                            </li>
                        </ul>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        {# 风扇 #}
        $('[name="status1"]').bootstrapSwitch({
            onText:"开启",
            offText:"关闭",
            onColor:"primary",
            size:"small",
            onSwitchChange:function(event,state){
                if(state==true&&flags1==2){
                    setswitch('fan',1);
                }
                if(state==false&&flags1==2){
                    setswitch('fan',0);
                }
            }
        });
        {# 窗帘 #}
        $('[name="status2"]').bootstrapSwitch({
            onText:"开启",
            offText:"关闭",
            onColor:"primary",
            {#            offColor:"success",#}
            size:"small",
            onSwitchChange:function(event,state){
                if(state==true&&flags2==2){
                    setswitch('curtain',1);
                }
                if(state==false&&flags2==2){
                    setswitch('curtain',0);
                }
            }
        });
        {# 电源 #}
        $('[name="status3"]').bootstrapSwitch({
            onText:"正常",
            offText:"备用",
            onColor:"primary",
            size:"small",
            onSwitchChange:function(event,state){
                if(state==true&&flags3==2){
                    setswitch('power',1);
                }
                if(state==false&&flags3==2){
                    setswitch('power',2);
                }
            }
        });
        {# 教室1的照明灯开关 #}
        $('[name="status-room-1"]').bootstrapSwitch({
            onText:"开启",
            offText:"关闭",
            onColor:"primary",
            size:"small",
            onSwitchChange:function(event,state){
                if(state==true&&flagrs1==2&&flagcls==2){
                    var bright = $('#ex1').slider('getValue');
                    if(bright==0){
                        $('#light-reminder').empty();
                        $('#light-reminder').append("亮度不能为0");
                        flagrs1=1;
                        $('[name="status-room-1"]').bootstrapSwitch('state', false);
                        flagrs1=2;
                    }else{
                        $('#light-reminder').empty();
                        setlights(1,1,bright);
                    }
                }
                if(state==false&&flagrs1==2){
                    setlights(1,0,0);
                }
            }
        });
        {# 教室2的照明灯开关 #}
        $('[name="status-room-2"]').bootstrapSwitch({
            onText:"开启",
            offText:"关闭",
            onColor:"primary",
            size:"small",
            onSwitchChange:function(event,state){
                if(state==true&&flagrs2==2&&flagcls==2){
                    var bright = $('#ex2').slider('getValue');
                    if(bright==0){
                        $('#light-reminder').empty();
                        $('#light-reminder').append("亮度不能为0");
                        flagrs2=1;
                        $('[name="status-room-2"]').bootstrapSwitch('state', false);
                        flagrs2=2;
                    }else{
                        $('#light-reminder').empty();
                        setlights(2,1,bright);
                    }
                }
                if(state==false&&flagrs2==2){
                    setlights(2,0,0);
                }
            }
        });
        {# 教室3的照明灯开关 #}
        $('[name="status-room-3"]').bootstrapSwitch({
            onText:"开启",
            offText:"关闭",
            onColor:"primary",
            {#            offColor:"danger",#}
            size:"small",
            onSwitchChange:function(event,state){
                if(state==true&&flagrs3==2&&flagcls==2){
                    var bright = $('#ex3').slider('getValue');
                    if(bright==0){
                        $('#light-reminder').empty();
                        $('#light-reminder').append("亮度不能为0");
                        flagrs3=1;
                        $('[name="status-room-3"]').bootstrapSwitch('state', false);
                        flagrs3=2;
                    }else{
                        $('#light-reminder').empty();
                        setlights(3,1,bright);
                    }
                }
                if(state==false&&flagrs3==2){
                    setlights(3,0,0);
                }
            }
        });
        $('#ex1').slider({
            formatter: function(value) {
                return 'value: ' + value;
            }
        }).on('slideStop',function (e) {
            var bright = e.value;
            if($('[name="status-room-1"]').bootstrapSwitch('state')==true&&flagcls==2){
                setlights(1,1,bright);
            }
        });
        $('#ex2').slider({
            formatter: function(value) {
                return 'value: ' + value;
            }
        }).on('slideStop',function (e) {
            var bright = e.value;
            if($('[name="status-room-2"]').bootstrapSwitch('state')==true&&flagcls==2){
                setlights(2,1,bright);
            }
        });
        $('#ex3').slider({
            formatter: function(value) {
                return 'value: ' + value;
            }
        }).on('slideStop',function (e) {
            var bright = e.value;
            if($('[name="status-room-3"]').bootstrapSwitch('state')==true&&flagcls==2){
                setlights(3,1,bright);
            }
        });
    </script>
</div>
<!--安防系统-->
<div class="container" id="list-3" style="display: none">
    <div id="security-header">
        <div id="secu-status" style="width: 100%;">
            <div class="row" style="width: 100%;margin-left: 20px">
                <div>
                    <div style="position: absolute;" id="loader8"> </div>
                    <div style="position:absolute">
                        <img src="{% static 'img/security-camera.svg' %}" alt="automobile-bot"class="security-icon" id="security-pic">
                        <img src="{% static 'img/security-camera1.png' %}" alt="automobile-bot"class="security-icon" id="unsecurity-pic" style="display: none;">
                    </div>
                </div>
                <div class="col-lg-2" style="margin-top: 10px;margin-left: 80px;">
                    <span>安防状态</span>
                    <li class="normal-color" style="width: 50px;text-align: center;" id="guard-alarm"><span id="set-status" >正常</span></li>
                </div>
                <div class="col-lg-2">
                    <a class="btn btn-red" href="javascript:closealarm()" id="alarm-btn">关闭安防报警</a>
                </div>
                <div class="col-lg-2">
                    <a class="btn btn-red" href="javascript:fingerprint(0);" id="alarm-btn">开始录入指纹</a>
                </div>
                <div class="col-lg-2">
                    <a class="btn btn-red" href="javascript:fingerprint(1);" id="alarm-btn">开始匹配</a>
                </div>
            </div>
        </div>
        <div class="query-condition">
            <h5>查询用户的门禁记录：</h5>
            <div class="col-lg-3">
                <span>用户ID</span><input class="date-input" name="secu-user">
            </div>
            <div class="input-append date form_datetime col-lg-4" data-date="2013-02-21T15:00Z">
                <span>开始时间</span>
                <input size="16" type="text" value="" name="starttime" class="date-input">
                <span class="add-on"><i class="icon-remove fa fa-remove"></i></span>
                <span class="add-on"><i class="icon-calendar fa fa-calendar"></i></span>
            </div>
            <div class="input-append date form_datetime col-lg-5" data-date="2013-02-21T15:00Z">
                <span>结束时间</span>
                <input size="16" type="text" value="" name="endtime" class="date-input">
                <span class="add-on"><i class="icon-remove fa fa-remove"></i></span>
                <span class="add-on"><i class="icon-calendar fa fa-calendar"></i></span>
                <a class="btn btn-red" href="javascript:searchentrance();" style="float: right">搜索</a>
            </div>
        </div>
        <div id="search-entr-reminder" class="error-reminder"></div>
        <br>
        <br>
        <div class="result-box">
            <h5 >搜索结果为</h5>
            <div class="data-show" id="secu-result"></div>
        </div>
    </div>
</div>
<!--消防系统-->
<div class="container" id="list-4" style="display: none">
    <div class="firestatus">
        <div class="fire-control row">
            <div class="col-lg-3">
                <h4>火灾报警：</h4>
                <p class="ever" id="fire-alarm">一切正常，未发生火灾警报！</p>
            </div>
           <div class="col-lg-3">
                <a class="btn btn-red" href="javascript:closefirealarm();" id="fire-alarm-btn">关闭消防报警</a>
           </div>
        </div>

        <div class="firestatus-grids">
            <div class="col-md-3 firestatus-grid">
                <div class="firestatus-grd">
                    <div class="icons">
                        <img src="{% static '/img/gas.svg'%}" alt="e sense" class="width-30">
                    </div>
                    <h4>甲烷传感器</h4>
                    <p id="ch4-status">甲烷浓度低于安全阈值</p>
                    <p id="ch4-status1">无火灾隐患</p>
                </div>
            </div>
            <div class="col-md-3 firestatus-grid">
                <div class="firestatus-grd">
                    <div class="icons">
                        <img src="{% static '/img/fire-light.svg'%}" alt="e sense" class="width-30">
                    </div>
                    <h4>火光传感器</h4>
                    <p id="fire-status">火光亮度低于安全阈值</p>
                    <p id="fire-status1">无火灾隐患</p>
                </div>
            </div>
            <div class="col-md-3 firestatus-grid">
                <div class="firestatus-grd">
                    <div class="icons">
                        <img src="{% static '/img/wireless.svg'%}" alt="e sense" class="width-30">
                    </div>
                    <h4>红外线传感器</h4>
                    <p id="ray-status">红外线强度低于安全阈值</p>
                    <p id="ray-status1">无火灾隐患</p>
                </div>
            </div>
            <div class="col-md-3 firestatus-grid">
                <div class="firestatus-grd">
                    <div class="icons">
                        <img src="{% static '/img/smoke1.svg'%}" alt="e sense" class="width-30">
                    </div>
                    <h4>烟雾传感器</h4>
                    <p id="smoke-status">烟雾浓度低于安全阈值</p>
                    <p id="smoke-status1">无火灾隐患</p>
                </div>
            </div>
        </div>
    </div>
</div>
<!--历史数据-->
<div class="container history-table" id="list-5" style="display: none">
    <form name="history-data" id="history-data" action="/" method="post">
        <!--当前所在界面 小导航-->
        <div class="row third-nav">
            <div class="col-md-11">
                <ol class="current-page-nav breadcrumb" style="float: left">
                    <li class="breadcrumb-item"><a href="#">Home</a></li>
                    <li class="breadcrumb-item"><a href="#">Data</a></li>
                    <li class="breadcrumb-item">HistoryData</li>

                </ol>
        <!-- 按照天数查找的小导航 -->
                <ul class="nav nav-pills" style="float: right;">
                    <li class="dropdown all-camera-dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                            展示天数
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu">
                            <li data-filter-camera-type="all"><a data-toggle="tab" href="#">最近2天</a></li>
                            <li data-filter-camera-type="Alpha"><a data-toggle="tab" href="#">最近5天</a></li>
                        </ul>
                    </li>
                 </ul>
            </div>

        </div>

        <!--数据表格-->
        <div class="row figure-pic">
            <div class="col-md-11 figure-pic-tmp style-feature">
                <div class=" figure-pic-header">
                    <h3><i class="fa fa-bar-chart-o"></i>异常日志</h3> <em>- Gates, Locks, and Fire Alarm</em>
                    <button type="button" class="btn btn-link btn-help" data-original-title="" title=""><i class="fa fa-question-circle"></i></button>
                    <div class="btn-group figure-pic-header-toolbar">
                        <a href="#" id="tour-focus" title="Focus" class="btn-borderless btn-focus"><i class="fa fa-eye"></i></a>
                        <a href="#" title="Expand/Collapse" class="btn-borderless btn-toggle-expand"><i class="fa fa-chevron-up"></i></a>
                        <a href="#" title="Remove" class="btn-borderless btn-remove"><i class="fa fa-times"></i></a>
                    </div>
                </div>
                <div class="figure-pic-content" id="tmp-chart">
                    <div id="ticket-table_wrapper" class="dataTables_wrapper form-inline no-footer">

                        <table id="ticket-table" class="table table-sorting dataTable no-footer" role="grid">
                            <thead>
                            <tr role="row"><th class="sorting" tabindex="0" aria-controls="ticket-table" rowspan="1"
                                               colspan="1" aria-label="Number: activate to sort column ascending" style="width:15%">
                                异常编号</th>
                                <th class="sorting table-header-1" tabindex="0" aria-controls="ticket-table" rowspan="1"
                                    colspan="1" aria-label="Date: activate to sort column ascending" style="width: 28%">
                                    发生日期</th>
                                <th class="sorting table-header" tabindex="0" aria-controls="ticket-table" rowspan="1"
                                    colspan="1" aria-label="Name: activate to sort column ascending" style="width: 25%">
                                    异常类型</th>
                                <th class="sorting table-header" tabindex="0" aria-controls="ticket-table" rowspan="1"
                                    colspan="1" aria-label="Title: activate to sort column ascending">
                                    异常传感器</th>
                            </tr>
                            </thead>
                            <tbody id="abnormal"></tbody>
                        </table><div class="row"></div></div>
                </div>
            </div>
        </div>

        <!--数据折线图1 2 3 4 温度 湿度 PM2.5 紫外线-->
        <div class="row figure-pic">
            <div class="col-md-11 figure-pic-tmp style-feature">
                <div class="figure-pic-header">
                    <h3><i class="fa fa-bar-chart-o"></i> 温度</h3> <em>- CO2 Concentration</em>
                    <button type="button" class="btn btn-link btn-help" data-original-title="" title=""><i class="fa fa-question-circle"></i></button>
                    <div class="btn-group figure-pic-header-toolbar">
                        <a href="#" id="tour-focus" title="Focus" class="btn-borderless btn-focus"><i class="fa fa-eye"></i></a>
                        <a href="#" title="Expand/Collapse" class="btn-borderless btn-toggle-expand"><i class="fa fa-chevron-up"></i></a>
                        <a href="#" title="Remove" class="btn-borderless btn-remove"><i class="fa fa-times"></i></a>
                    </div>
                </div>
                <div class="figure-pic-content" id="tmpHistory">
                </div>
            </div>
        </div>

        <div class="row figure-pic">
            <div class="col-md-11 figure-pic-tmp style-feature">
                <div class="figure-pic-header">
                    <h3><i class="fa fa-bar-chart-o"></i> 湿度</h3> <em>- CO2 Concentration</em>
                    <button type="button" class="btn btn-link btn-help" data-original-title="" title=""><i class="fa fa-question-circle"></i></button>
                    <div class="btn-group figure-pic-header-toolbar">
                        <a href="#" id="tour-focus" title="Focus" class="btn-borderless btn-focus"><i class="fa fa-eye"></i></a>
                        <a href="#" title="Expand/Collapse" class="btn-borderless btn-toggle-expand"><i class="fa fa-chevron-up"></i></a>
                        <a href="#" title="Remove" class="btn-borderless btn-remove"><i class="fa fa-times"></i></a>
                    </div>
                </div>
                <div class="figure-pic-content" id="humidityHistory">
                </div>
            </div>
        </div>

        <div class="row figure-pic">
            <div class="col-md-11 figure-pic-tmp style-feature">
                <div class="figure-pic-header">
                    <h3><i class="fa fa-bar-chart-o"></i> PM2.5</h3> <em>- CO2 Concentration</em>
                    <button type="button" class="btn btn-link btn-help" data-original-title="" title=""><i class="fa fa-question-circle"></i></button>
                    <div class="btn-group figure-pic-header-toolbar">
                        <a href="#" id="tour-focus" title="Focus" class="btn-borderless btn-focus"><i class="fa fa-eye"></i></a>
                        <a href="#" title="Expand/Collapse" class="btn-borderless btn-toggle-expand"><i class="fa fa-chevron-up"></i></a>
                        <a href="#" title="Remove" class="btn-borderless btn-remove"><i class="fa fa-times"></i></a>
                    </div>
                </div>
                <div class="figure-pic-content" id="pm25History">
                </div>
            </div>
        </div>

        <div class="row figure-pic">
            <div class="col-md-11 figure-pic-tmp style-feature">
                <div class="figure-pic-header">
                    <h3><i class="fa fa-bar-chart-o"></i> 紫外线</h3> <em>- CO2 Concentration</em>
                    <button type="button" class="btn btn-link btn-help" data-original-title="" title=""><i class="fa fa-question-circle"></i></button>
                    <div class="btn-group figure-pic-header-toolbar">
                        <a href="#" id="tour-focus" title="Focus" class="btn-borderless btn-focus"><i class="fa fa-eye"></i></a>
                        <a href="#" title="Expand/Collapse" class="btn-borderless btn-toggle-expand"><i class="fa fa-chevron-up"></i></a>
                        <a href="#" title="Remove" class="btn-borderless btn-remove"><i class="fa fa-times"></i></a>
                    </div>
                </div>
                <div class="figure-pic-content" id="uvHistory">
                </div>
            </div>
        </div>




    </form>
</div>
<!--查询功能-->
<div class="container search-container" id="list-6" style="display: none">
    <div id="data-search">
        <div class="form-group col-lg-3">
            <select class="form-control" id="searchtype">
                <option value="weather">天气监测记录</option>
                <option value="room">房间环境监测记录</option>
                <option value="park">停车场进出记录</option>
                <option value="security">门禁访问记录</option>
                <option value="alarminfo">报警情况记录</option>
            </select>
        </div>
        <div class="col-lg-9">
            <div class="input-append date form_datetime col-lg-5" data-date="2013-02-21T15:00Z">
                <span>开始时间</span>
                <input size="16" type="text" value="" name="starttime_a" class="date-input">
                <span class="add-on"><i class="icon-remove fa fa-remove"></i></span>
                <span class="add-on"><i class="icon-calendar fa fa-calendar"></i></span>
            </div>
            <div class="input-append date form_datetime col-lg-7" data-date="2013-02-21T15:00Z">
                <span>结束时间</span>
                <input size="16" type="text" value="" name="endtime_a" class="date-input">
                <span class="add-on"><i class="icon-remove fa fa-remove"></i></span>
                <span class="add-on"><i class="icon-calendar fa fa-calendar"></i></span>
                <a class="btn btn-red" href="javascript:searchhistoryrecord();" style="float: right">搜索</a>
            </div>
        </div>
    </div>
    <div id="search-type-reminder" class="error-reminder"></div>
    <br>
    <div class="result-box">
        <h5>搜索结果为</h5>
        <div class="data-show" id="search-result"></div>
    </div>
    <div id="sensor-search" style="margin-top: 50px;width: 100%">
        <div id="sensor-query">
            <div class="form-group col-lg-3">
                <select class="form-control" id="select-sensor">
                    <option value="light">光照传感器</option>
                    <option value="co2">CO2传感器</option>
                    <option value="tem">温度传感器</option>
                    <option value="hum">湿度传感器</option>
                    <option value="ray">紫外线传感器</option>
                    <option value="pm">PM2.5传感器</option>
                </select>
            </div>
            <div class="col-lg-9">
                <div class="input-append date form_datetime col-lg-5" data-date="2013-02-21T15:00Z">
                    <span>开始时间</span>
                    <input size="16" type="text" value="" name="starttime_sen" class="date-input">
                    <span class="add-on"><i class="icon-remove fa fa-remove"></i></span>
                    <span class="add-on"><i class="icon-calendar fa fa-calendar"></i></span>
                </div>
                <div class="input-append date form_datetime col-lg-7" data-date="2013-02-21T15:00Z">
                    <span>结束时间</span>
                    <input size="16" type="text" value="" name="endtime_sen" class="date-input">
                    <span class="add-on"><i class="icon-remove fa fa-remove"></i></span>
                    <span class="add-on"><i class="icon-calendar fa fa-calendar"></i></span>
                    <a class="btn btn-red" href="javascript:searchsensorrecord();" style="float: right">搜索</a>
                </div>
            </div>
        </div>
        <div id="search-sen-reminder"></div>

        <br>
        <div class="result-box">
            <h5>搜索结果为</h5>
            <div class="data-show" id="search-result-sen"></div>
        </div>
        <br>
    </div>
    {# 事件选择框初始化 #}
    <script type="text/javascript">
        $(".form_datetime").datetimepicker({
            format: "yyyy-mm-dd hh:00",
            autoclose: true,
            todayBtn: true,
            startDate: "2018-07-14",
            minuteStep: 30,
            minView:1,
            language:'zh-CN'
        });
    </script>
</div>
<script type="text/javascript">

     /******************************************************************
     * 取当前时间
     * */
    //取时间
    function fnTime() {
        var currentDate = new Date();
        var hours = currentDate.getHours();
        var minute = currentDate.getMinutes();
        var second = currentDate.getSeconds();
        var time = fnW(hours)+":"+fnW(minute)+":"+fnW(second);
        return time;
    }
    //补位 当某个字段不是两位数时补0
    function fnW(str){
        var num;
        str>=10?num=str:num="0"+str;
        return num;
    }

    /********************************************************************
     * 仪表盘值
     * */
    var co2;
    var lightintensity;
    var indoortmp;
    var indoorhumidty;

     /*温度图*
    ********************************************************************************
     */
    var tmpdata = [];
    var tmpChart = echarts.init(document.getElementById('tmp-chart'));
    var date = [];

    //设置图标配置项
    tmpChart.setOption({
        title:{
            text:' 温度'
        },
        xAxis:{
            type:"category",
            boundaryGap:false,
            data:date
        },
        yAxis:{
            boundaryGap:[0,'100%'],
            type:'value'
        },
        series:[{
            name:'成交',
            type:'line',
            smooth:true, //数据光滑过度
            symbol:'none', //下一个数据点
            stack:'a',
            lineStyle:{
              color:'#adcafb'
            },
            areaStyle:{
                normal:{
                    color:'#517FA4'
                }
            },
            data:tmpdata
        }]
    })


    /*CO2图*
    ********************************************************************************
     */
    var co2data = [];
    var co2Chart = echarts.init(document.getElementById('co2-chart'));
    //设置图标配置项
    co2Chart.setOption({
        title:{
            text:' CO2'
        },
        xAxis:{
            type:"category",
            boundaryGap:false,
            data:date
        },
        yAxis:{
            boundaryGap:[0,'100%'],
            type:'value'
        },
        series:[{
            name:'成交',
            type:'line',
            smooth:true, //数据光滑过度
            symbol:'none', //下一个数据点
            stack:'a',
            lineStyle:{
              color:'#adcafb'
            },
            areaStyle:{
                normal:{
                    color:'#517FA4'
                }
            },
            data:co2data
        }]
    })


     /*光强图*
    ********************************************************************************
     */
    var intensitydata = [];
    //温度图
    var intensityChart = echarts.init(document.getElementById('intensity-chart'));
    //设置图标配置项
    intensityChart.setOption({
        title:{
            text:' 光强'
        },
        xAxis:{
            type:"category",
            boundaryGap:false,
            data:date
        },
        yAxis:{
            boundaryGap:[0,'100%'],
            type:'value'
        },
        series:[{
            name:'成交',
            type:'line',
            smooth:true, //数据光滑过度
            symbol:'none', //下一个数据点
            stack:'a',
            lineStyle:{
              color:'#adcafb'
            },
            areaStyle:{
                normal:{
                    color:'#517FA4'
                }
            },
            data:intensitydata
        }]
    })

    //设置实时折线图显示几个数据
    function deleteDataOrNot(shift){
        if (shift) {
            if(date.length >= 10){
                date.shift();
                tmpdata.shift();
                intensitydata.shift();
                co2data.shift();
            }
        }
    }
</script>

<script>
    //历史数据图

        //温度折线图


        $('#la5').click(function () {

             var tmpHistory = echarts.init(document.getElementById('tmpHistory'));
                option1 = {
                title: {
                text: '温度'
                },
                tooltip: {
                trigger: 'axis'
                },
                grid: {
                left: '5%',
                right: '10%',
                bottom: '20%',
                containLabel: true
                },
                color: ['#e50f29'],
                xAxis: {
                type: 'category',
                boundaryGap: false,
                data: ['周一','周二','周三','周四','周五'],
                axisLine:{
                lineStyle: {
                type : 'solid',
                color : '#666'
                },
                }
                },
                yAxis: {
                zlevel: 0,
                type: 'value',
                axisLine : {
                show : false,
                lineStyle:{
                color:'#dfe3e3'
                }
                },
                axisTick : {
                show : false
                },
                boundaryGap: ['20%', '20%'],
                scale : false,
                min : 0,
                type : 'value',
                splitLine : {
                lineStyle : {
                type : 'dotted'
                }
                }
                },
                series: [
                {
                name:'温度',
                type:'line',
                stack: '分数',
                lineStyle: {
                normal: {
                width: 1
                }
                },
                data:[0,12,23,23,25]
                },
                ]
                };

                // 湿度历史数据
            var humidityHistory = echarts.init(document.getElementById('humidityHistory'));
                option2 = {
                title: {
                text: '湿度'
                },
                tooltip: {
                trigger: 'axis'
                },
                grid: {
                left: '5%',
                right: '10%',
                bottom: '20%',
                containLabel: true
                },
                color: ['#e50f29'],
                xAxis: {
                type: 'category',
                boundaryGap: false,
                data: ['周一','周二','周三','周四','周五'],
                axisLine:{
                lineStyle: {
                type : 'solid',
                color : '#666'
                },
                }
                },
                yAxis: {
                zlevel: 0,
                type: 'value',
                axisLine : {
                show : false,
                lineStyle:{
                color:'#dfe3e3'
                }
                },
                axisTick : {
                show : false
                },
                boundaryGap: ['20%', '20%'],
                scale : false,
                min : 0,
                type : 'value',
                splitLine : {
                lineStyle : {
                type : 'dotted'
                }
                }
                },
                series: [
                {
                name:'湿度',
                type:'line',
                stack: '分数',
                lineStyle: {
                normal: {
                width: 1
                }
                },
                data:[0,12,23,23,25]
                },
                ]
                };


                //PM2.5折线图
            var pm25History = echarts.init(document.getElementById('pm25History'));
                option3 = {
                title: {
                text: 'PM2.5'
                },
                tooltip: {
                trigger: 'axis'
                },
                grid: {
                left: '5%',
                right: '10%',
                bottom: '20%',
                containLabel: true
                },
                color: ['#e50f29'],
                xAxis: {
                type: 'category',
                boundaryGap: false,
                data: ['周一','周二','周三','周四','周五'],
                axisLine:{
                lineStyle: {
                type : 'solid',
                color : '#666'
                },
                }
                },
                yAxis: {
                zlevel: 0,
                type: 'value',
                axisLine : {
                show : false,
                lineStyle:{
                color:'#dfe3e3'
                }
                },
                axisTick : {
                show : false
                },
                boundaryGap: ['20%', '20%'],
                scale : false,
                min : 0,
                type : 'value',
                splitLine : {
                lineStyle : {
                type : 'dotted'
                }
                }
                },
                series: [
                {
                name:'PM2.5',
                type:'line',
                stack: '分数',
                lineStyle: {
                normal: {
                width: 1
                }
                },
                data:[0,12,23,23,25]
                },
                ]
                };

                //UV折线图
            var uvHistory = echarts.init(document.getElementById('uvHistory'));
                option4 = {
                title: {
                text: 'UV'
                },
                tooltip: {
                trigger: 'axis'
                },
                grid: {
                left: '5%',
                right: '10%',
                bottom: '20%',
                containLabel: true
                },
                color: ['#e50f29'],
                xAxis: {
                type: 'category',
                boundaryGap: false,
                data: ['周一','周二','周三','周四','周五'],
                axisLine:{
                lineStyle: {
                type : 'solid',
                color : '#666'
                },
                }
                },
                yAxis: {
                zlevel: 0,
                type: 'value',
                axisLine : {
                show : false,
                lineStyle:{
                color:'#dfe3e3'
                }
                },
                axisTick : {
                show : false
                },
                boundaryGap: ['20%', '20%'],
                scale : false,
                min : 0,
                type : 'value',
                splitLine : {
                lineStyle : {
                type : 'dotted'
                }
                }
                },
                series: [
                {
                name:'UV',
                type:'line',
                stack: '分数',
                lineStyle: {
                normal: {
                width: 1
                }
                },
                data:[0,12,23,23,25]
                },
                ]
                };
            tmpHistory.setOption(option1);
            window.onresize = tmpHistory.resize;
            humidityHistory.setOption(option2);
            pm25History.setOption(option3);
            uvHistory.setOption(option4);
        })
</script>
</body>
</html>